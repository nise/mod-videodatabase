Vi2.Observer=$.inherit({__constructor:function(a){vi2.observer=this;this.options=$.extend(this.options,a);this.widget_list={};this.clock=new Vi2.Clock(this.options.clockInterval)},name:"observer",options:{id:"start",embed:!0,selector:"#screen",clockInterval:500,videoSelector:"#video1",videoWidth:500,videoHeight:375,videoControlsSelector:".video-controls",markupType:"wiki",childtheme:""},pieList:$("<ul></ul>").attr("class","pieContextMenu").attr("id","menu"),player:void 0,clock:void 0,parseSelector:"",
widget:void 0,widget_list:[],hooks:[],vid_arr:[],current_stream:"start",seek:0,parser:"",setCurrentStream:function(a,b){this.current_stream=a;this.seek=b;$("<div></div>").attr("type","video").attr("starttime",0).attr("duration",7).attr("id","myvideo").text(vi2.db.getStreamById(a).video).appendTo("#vi2");this.clock.stopClock();this.clock.reset();new Vi2.Metadata;this.parse(vi2.dom,"html")},parse:function(a,b){this.parseSelector=a;this.parser=new Parser(a,null===b?this.markupType:b);this.vid_arr=[];
this.vid_arr=this.parser.run();this.clock.stopClock();this.clock.reset();this.player.loadSequence(this.vid_arr,0,this.seek)},init:function(a){var b=this;this.player=new Video({embed:this.options.embed,selector:this.options.videoSelector,width:this.options.videoWidth,height:this.options.videoHeight,videoControlsSelector:this.options.videoControlsSelector,theme:this.options.theme,childtheme:this.options.childtheme,thumbnail:this.options.thumbnail,seek:void 0===a?0:a},this);$(this).bind("player.ready",
function(a,c,f){b.setAnnotations()})},setAnnotations:function(){var a=this;this.clock.annotations=[];this.vid_arr=this.parser.run();$.each(a.vid_arr[0].annotation,function(b,e){a.clock.addAnnotation(e)});$.each(a.widget_list,function(b,e){"player-widget"!==e.type?e.init(a.vid_arr[0].annotation):e.init()})},updateLocation:function(a,b){window.location.replace(window.location.href.split("#")[0]+"#!"+a+":"+b.replace(/\ /g,"_"))},addWidget:function(a){a.player=this.player;this.clock.addHook(a.name,a);
"annotation"===a.type&&(a.appendToDOM(this.current_stream),$(this.player).bind("annotation.begin."+a.name,function(b,e,c){a.begin(b,e,c)}),$(this.player).bind("annotation.end."+a.name,function(b,e,c){a.end(b,e,c)}));switch(a.name){case "relatedVideos":$(this.player).bind("video.end",function(b,e){a.showLinkSummary()});break;case "log":$(this.player).bind("log",function(b,e){a.add(e)})}this.widget_list[a.name]=a;return!0},isWidget:function(a){return null!==this.widget_list[a]},getWidget:function(a){return this.widget_list[a]},
removeWidget:function(a){this.widget_list[a]=0},annotationsToDOM:function(){var a=this;$.each(this.widget_list,function(b,e){"annotation"===e.type&&e.appendToDOM(a.current_stream)})},ended:function(){},pause:function(){this.clock.stopClock()},play:function(){},log:function(a){$(this.player).trigger("log",[a])},destroy:function(){$("video").stop();this.clock.reset();$("#vi2").empty()}});
Vi2.DataBase=$.inherit({__constructor:function(a,b,e,c){this.call_back=b;var f=this;this.options=$.extend(this.options,a);this._d=0;$.each(this.options.jsonFiles,function(a,c){console.log("making requst for "+c.path);f.loadJSON(c.path,c.storage,e)})},name:"dataBase",mode:"",options:{path:"",jsonFiles:[]},call_back:{},_d:0,json_data:{},json_slide_data:{},json_user_data:{},content_selector:"#content",dom:"#hydro1",loadJSON:function(a,b,e){var c=this;$.ajax({type:"get",beforeSend:function(a){a.overrideMimeType&&
a.overrideMimeType("application/json")},url:c.options.path+a,dataType:"json",success:function(a){c[b]=a;c._d++;c._d===Object.size(c.options.jsonFiles)&&(console.log("done"),c.call_back[e]());"vi-lab"!==c.mode&&void 0!==c.json_data._name&&(c.json_data=c.json_data.stream)},error:function(a){console.log(JSON.stringify(a));window.location="/login"}})},isStream:function(a){var b=!1;$.each(this.json_data,function(e){this.id===a&&(b=!0)});return b},getStreamById:function(a){if(void 0===this.json_data)return{};
if("vi-lab"===this.mode)return this.json_data;var b={};$.each(this.json_data,function(e,c){c.id===a&&(b=this)});return b},getAllCategories:function(){return this.json_data.categories},getCategoryTaxonomie:function(){var a={};$.each(this.json_data.categories,function(b,e){a[this.pos]={first_level:this.title,desc:this.desc}});return a},getCategory:function(a){var b={};$.each(this.json_data.categories,function(e,c){this.title===a&&(b={first_level:this.title,desc:this.desc,pos:this.pos,link:this.link,
icon:this.icon})});return b},getMetadataById:function(a){if(void 0!==this.getStreamById(a))return this.getStreamById(a).metadata[0]},getTitles:function(){var a=[];$.each(this.json_data,function(b){a.push({first_level:this.metadata[0].title})});return removeDuplicates(a)},getAuthors:function(){var a=[];$.each(this.json_data,function(b){a.push({first_level:this.metadata[0].author})});return removeDuplicates(a)},getStreamsOfSameAuthor:function(a){var b=this.getMetadataById(a).author,e=[];$.each(this.json_data,
function(c,f){f.metadata[0].author===b&&f.id!=a&&e.push(f.id)});return e},getTagsById:function(a){return void 0===this.json_data.tags?{}:this.getStreamById(a).tags},getCommentsById:function(a){return null===this.getStreamById(a).comments?{}:this.getStreamById(a).comments},getTagList:function(){var a=[];$.each(this.json_data,function(b){$.each(this.tags,function(b){a.push({first_level:this.tagname})})});return this.removeDuplicates(a).sort()},getTagTaxonomie:function(){var a=[];$.each(this.json_data._taxonomy,
function(b,e){a.push({first_level:this.id,second_level:this.sub})});return a},getStreamsWithSameTag:function(a){var b=this,e=[];a=this.getStreamById(a).tags;$.each(a,function(a,f){$.each(b.json_data,function(a,c){$.each(c.tags,function(a,b){this.tagname===f.tagname&&e.push(c.id)})})});return e},getRandomStreams:function(a){var b=[];$.each(this.json_data,function(a,c){b.push(c.id)});return b},getLinkTargetsById:function(a){var b=[];$.each(this.getStreamById(a).hyperlinks,function(a){b.push(this.target)});
return b},getLinkSourcesById:function(a){var b=[];$.each(this.json_data,function(e,c){$.each(c.hyperlinks,function(e,g){this.target===a&&b.push(c.id)})});return b},getLinksById:function(a){return this.getStreamById(a).hyperlinks},getAssessmentFillInById:function(a){return this.getStreamById(a).assessmentfillin},getAssessmentWritingById:function(a){return this.getStreamById(a).assessmentwriting},getAssessmentById:function(a){return void 0===this.json_data.assessment?{}:this.json_data.assessment},getAnalysisById:function(a){return null===
this.getStreamById(a).assessmentanalysis?{}:this.getStreamById(a).assessmentanalysis},getTocById:function(a){return void 0===this.json_data.toc?{}:this.getStreamById(a).toc},getHighlightById:function(a){return void 0===this.json_data.highlight?{}:this.getStreamById(a).highlight},getSlidesById:function(a){return this.getStreamById(a).slides},hasSlides:function(a){return void 0!==this.getStreamById(a).slides&&0<this.getStreamById(a).slides.length?!0:!1},getUserById:function(a){var b={};$.each(this.json_user_data,
function(e,c){Number(c.id)===Number(a)&&(b=c)});return b},getGroupById:function(a){var b={};$.each(this.json_group_data,function(e,c){Number(c.id)===Number(a)&&(b=c)});return b},getUserByGroupId:function(a,b){var e=[];$.each(this.json_user_data,function(c,f){f.groups[b]===a&&e.push(f)});return e},getVideoById:function(a){return $("<div></div>").attr("type","video").attr("starttime",0).attr("duration",7).attr("id","myvideo").text(this.getStreamById(a).video)}});
var Parser=$.inherit({__constructor:function(a,b){this.selector=a;this.type=b},vid_arr:[],selector:"",run:function(){switch(this.type){case "wiki":return this.parseWiki();case "html":return this.parseHtml()}},parseWiki:function(){var a=this,b=-1;$(this.selector).val($(this.selector).val().replace(/\<p\>/,""));$($(this.selector+" > p").text().split(/\n/)).each(function(e,c){"[[Video:"===c.substr(0,8)||"[[video:"===c.substr(0,8)?(b++,a.vid_arr[b]=a.parseWikiVideo(c)):"[["===c.substr(0,2)&&a.vid_arr[b].annotation.push(a.parseWikiHyperlink(c))});
return this.vid_arr},parseHtml:function(){var a=this,b=-1,e=[],c={},f=0;$("div"+this.selector+" div").each(function(g,h){f=new Date;c={};c.author=void 0===$(this).attr("author")?"":$(this).attr("author");c.date=void 0===$(this).attr("date")?f.getTime():$(this).attr("date");c.type=void 0===$(this).attr("type")?"none":$(this).attr("type");"video"===$(this).attr("type")?(e={},e.id=$(this).attr("id"),e.url=$(this).text(),e.seek=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),e.duration=
void 0===$(this).attr("duration")?0:$(this).attr("duration"),e.annotation=[],b++,a.vid_arr[b]=e):"hyperlinks"===$(this).attr("type")?(c.title=$(this).text(),c.description=$(this).attr("description"),c.target=$(this).attr("target"),c.linktype="standard",c.x=$(this).attr("posx"),c.y=$(this).attr("posy"),c.t1=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),c.t2=void 0===$(this).attr("duration")?0:$(this).attr("duration"),c.seek=$(this).attr("seek"),c.duration2=$(this).attr("duration2"),
c.target.match(RegExp(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi))&&(c.linktype="external"),a.vid_arr[b].annotation.push(c)):"cycle"===$(this).attr("type")?(c.title=$(this).text(),c.target=$(this).attr("target"),c.description=$(this).attr("description"),c.linktype="cycle",c.x=$(this).attr("posx"),c.y=$(this).attr("posy"),c.t1=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),c.t2=void 0===$(this).attr("duration")?0:$(this).attr("duration"),c.seek=
$(this).attr("seek"),c.duration=$(this).attr("duration2"),a.vid_arr[b].annotation.push(c)):"syncMedia"===$(this).attr("type")?(c.title=$(this).text(),c.target=$(this).attr("path"),c.linktype="",c.x=0,c.y=0,c.t1=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),c.t2=void 0===$(this).attr("duration")?0:$(this).attr("duration"),a.vid_arr[b].annotation.push(c)):"map"===$(this).attr("type")?(c.title="",c.target=$(this).text(),c.linktype="",c.type="map",c.x=0,c.y=0,c.t1=void 0===$(this).attr("starttime")?
0:$(this).attr("starttime"),c.t2=void 0===$(this).attr("duration")?0:$(this).attr("duration"),a.vid_arr[b].annotation.push(c)):"toc"===$(this).attr("type")?(c.title=$(this).text(),c.target=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),c.linktype="",c.note=$(this).attr("note"),c.x=0,c.y=0,c.t1=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),c.t2=1,a.vid_arr[b].annotation.push(c)):"tags"===$(this).attr("type")?(c.title=$(this).text(),c.target=void 0===$(this).attr("starttime")?
0:$(this).attr("starttime"),c.x=$(this).attr("posx"),c.y=$(this).attr("posy"),c.t1=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),c.t2=void 0===$(this).attr("duration")?0:$(this).attr("duration"),a.vid_arr[b].annotation.push(c)):"highlight"===$(this).attr("type")?(c.title=$(this).text(),c.target=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),c.linktype="",c.x=$(this).attr("posx"),c.y=$(this).attr("posy"),c.t1=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),
c.t2=void 0===$(this).attr("duration")?0:$(this).attr("duration"),a.vid_arr[b].annotation.push(c)):"comments"===$(this).attr("type")?(c.title=$(this).text(),c.target=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),c.linktype="",c.x=0,c.y=0,c.t1=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),c.t2=1,a.vid_arr[b].annotation.push(c)):"assessmentanalysis"===$(this).attr("type")?(c.title=$(this).text(),c.target=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),
c.linktype="",c.x=$(this).attr("x"),c.y=$(this).attr("y"),c.t1=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),c.t2=void 0===$(this).attr("duration")?1:$(this).attr("duration"),c.marker=$(this).data("marker"),c.markertype=$(this).attr("markertype"),c.markerlabel=$(this).attr("markerlabel"),c.markerdescription=$(this).attr("markerdescription"),c.markerdescription2=$(this).attr("markerdescription2"),c.markerselect_option=$(this).attr("markerselectoption"),c.id=$(this).attr("id"),a.vid_arr[b].annotation.push(c)):
"assessment"===$(this).attr("type")?(c.title=$(this).data("task"),c.target=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),c.linktype="",c.type="assessment",c.x=0,c.y=0,c.t1=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),c.t2=1,a.vid_arr[b].annotation.push(c)):"assessment-fill-in"===$(this).attr("type")?(c.title=$(this).attr("id"),c.target=$(this).text(),c.linktype="standard",c.width=void 0===$(this).attr("width")?100:$(this).attr("width"),c.type="assessment-fill-in",
c.x=$(this).attr("posx"),c.y=$(this).attr("posy"),c.t1=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),c.t2=void 0===$(this).attr("duration")?0:$(this).attr("duration"),c.seek=$(this).attr("seek"),c.duration=$(this).attr("duration2"),a.vid_arr[b].annotation.push(c)):"assessment-writing"===$(this).attr("type")&&(c.title=encodeURIComponent($(this).text()),c.target=$(this).text(),c.linktype="standard",c.width=void 0===$(this).attr("width")?100:$(this).attr("width"),c.type="assessment-writing",
c.x=$(this).attr("posx"),c.y=$(this).attr("posy"),c.t1=void 0===$(this).attr("starttime")?0:$(this).attr("starttime"),c.t2=void 0===$(this).attr("duration")?0:$(this).attr("duration"),c.seek=$(this).attr("seek"),c.duration=$(this).attr("duration2"),a.vid_arr[b].annotation.push(c))});return a.vid_arr},parseWikiVideo:function(a){var b=[],e,c,f,g="_";a=a.replace(/^\[\[Video:/,"").replace(/\]\]/,"").replace(/\# /," #").replace(/\| /," |").replace(/  /," ");a=a.split(/ /);$.each(a,function(a,b){"#"===
b.substr(0,1)?c=b.substr(1,b.length):"|"===b.substr(0,1)?f=b.substr(1,b.length):b.match(/(?=.ogg)/)?e=b:0<b.length&&(g=b)});b.id=g;b.url=e;b.seek=void 0===c?0:c;b.duration=void 0===f?0:f;b.annotation=[];return b},parseWikiHyperlink:function(a){var b="",b="",e={type:"hyperlinks",linktype:"standard"},b=RegExp(/^\[\[http:\/\//);a.match(b)?(b=RegExp(/\[\[http:\/\/[a-z A-Z 0-9 \#\ \_\/:.-]+/),b=b.exec(a).toString().split(" "),e.target=b[0].replace(/^\[\[/,""),e.title=2<=b.length?b.slice(1):b[0].replace(/^[\[\[http:\/\/]/,
""),e.title=e.title.toString().replace(/,/g," "),e.linktype="external"):(b=RegExp(/\[\[[a-z A-Z 0-9 \# \ \_\/\|:.-]+/),b=b.exec(a).toString().split(/\|/),e.target=b[0].replace(/^\[\[/,""),e.title=2<=b.length?b[1]:b[0].replace(/^\[\[/,""));var c=a.split(/\]/),b=RegExp(/[\ ]\#[0-9]+/);e.t1=a.match(b)?b.exec(c[1]).toString().replace(/[\#]/,""):0;b=RegExp(/[\ ]\|[0-9]+/);e.t2=a.match(b)?b.exec(c[1]).toString().replace(/[\|]/,""):1E3;b=RegExp(/[\ ]+[0-9]{2}(?=\%)/g);b=a.match(b)?a.match(b).toString().split(/,/):
[50,50];e.x=b[0]?b[0]:50;e.y=b[1]?b[1]:50;return e}}),Video=$.inherit({__constructor:function(a){vi2.observer.player=this;this.options=$.extend(this.options,a);this.spinner=new Spinner(this.spinner_options);this.video=document.getElementById(this.options.selector.replace(/\#/,""));this.loadUI()},name:"video player",options:{observer:null,selector:"#video1",width:500,height:375,seek:0,videoControlsSelector:".video-controls",thumbnail:"/static/img/placeholder.jpg",defaultVolume:1},video:null,timeline:null,
observer:null,url:"",video_container:null,video_wrap:null,play_btn:null,volume_btn:null,volume:null,isMuted:!1,isSequence:!1,seqList:[],seqNum:null,seqLoop:!1,videoIsPlaying:!0,percentLoaded:0,buffclick:0,spinner:!1,spinner_options:{lines:6,length:0,width:20,radius:20,color:"#003366",speed:1,trail:89,shadow:!1,hwaccel:!1,className:"spinner",zIndex:29,top:"auto",left:"auto"},loadVideo:function(a,b){var e=this;this.url=a;this.seek=void 0===b?0:b;var c=$("<video></video>").attr("controls",!1).attr("autobuffer",
!0).attr("preload","metadata").attr("id","video1").css({width:"75vw"}).text("Your Browser does not support either this video format or videos at all");$("#seq").html(c);this.video=document.getElementById(this.options.selector.replace(/\#/,""));this.videoIsPlaying&&$(vi2.observer.player).trigger("player.play",[]);this.video.pause();this.startSpinning();c=this.detectVideoSupport();this.video=$.extend(this.video,{loop:!1,preload:"metadata",autoplay:this.videoIsPlaying,controls:!1,onerror:function(a){e.errorHandling(a)}});
this.timeline=new Vi2.AnnotatedTimeline(this.video,{},this.seek);this.logger();var f=new Vi2.PlaybackSpeed;vi2.observer.addWidget(f);f=new Vi2.SkipBack;vi2.observer.addWidget(f);this.play_btn=$(".vi2-video-play-pause");this.video.addEventListener("play",function(a){vi2.observer.clock.startClock();e.play_btn.find(".glyphicon-pause").show();e.play_btn.find(".glyphicon-play").hide()});this.video.addEventListener("pause",function(a){vi2.observer.clock.stopClock();$("header").show();e.play_btn.find(".glyphicon-pause").hide();
e.play_btn.find(".glyphicon-play").show()});this.video.addEventListener("abort",function(a){vi2.observer.clock.stopClock();$("header").show();e.play_btn.find(".glyphicon-pause").hide();e.play_btn.find(".glyphicon-play").show()});this.video.addEventListener("readystate",function(a){e.readyStateHandler(a)});this.video.addEventListener("timeupdate",function(a){e.timeUpdateHandler(a)});this.video.addEventListener("ended",function(a){e.endedHandler(a)},!1);f=new Date;$(vi2.observer).trigger("stream.loaded",
{stream:vi2.observer.current_stream,playback_time:b,time:f.getTime()});void 0!==a&&$(this.video).html(this.createSource(a,c),this.video.firstChild)},detectVideoSupport:function(){var a=document.createElement("video");if(""!==a.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'))return vi2.observer.log({context:"player",action:"video-support-mp4",values:["1"]}),"video/mp4";if(""!==a.canPlayType('video/webm; codecs="vp8, vorbis"'))return vi2.observer.log({context:"player",action:"video-support-webm",
values:["1"]}),"video/webm";if(""!==a.canPlayType('video/ogg; codecs="theora, vorbis"'))return vi2.observer.log({context:"player",action:"video-support-ogv",values:["1"]}),"video/ogv";vi2.observer.log({context:"player",action:"video-support-none",values:["1"]});$("#page").html('<h3>We appologize that video application is currently not supported by your browser.</h3>The provided video material can be played on Mozilla Firefox, Google Chrome and Opera. If you prefer Internet Explorer 9 you need to install a <a href="https://tools.google.com/dlpage/webmmf">webm video extension</a> provided by Google. In the near future we are going to server further video formats which will be supported by all major browsers.<br /><br /> Thank you for your understanding.');
return""},detectBrowser:function(){var a=navigator.userAgent,b,e=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(e[1]))return b=/\brv[ :]+(\d+)/g.exec(a)||[],"IE "+(b[1]||"");if("Chrome"===e[1]&&(b=a.match(/\b(OPR|Edge)\/(\d+)/),null!=b))return b.slice(1).join(" ").replace("OPR","Opera");e=e[2]?[e[1],e[2]]:[navigator.appName,navigator.appVersion,"-?"];null!=(b=a.match(/version\/(\d+)/i))&&e.splice(1,1,b[1]);return e[0]},loadSequence:function(a,b,e){this.seqList=
a;this.seek=e;this.isSequence=!0;this.seqNum=void 0===b?0:b;this.loadVideo(this.seqList[this.seqNum].url,this.seek)},createSource:function(a,b){var e=".mp4",c=document.createElement("source");"Firefox"===this.detectBrowser()?(e=".webm",b="video/webm"):"Chrome"===this.detectBrowser()&&(e=".webm",b="video/webm");c.src=a.replace(".mp4",e)+"?foo="+(new Date).getTime();c.type=b;return c},loadUI:function(){function a(){e=null;document.body.style.cursor="none";c=!1;$(b.options.videoControlsSelector).removeClass("open-controls")}
var b=this;this.createPlaybackControl();this.createVolumeControl();this.createVideoHiding();$(b.options.videoControlsSelector).addClass("open-controls");var e=null,c=!0;document.getElementById("video1");document.onmousemove=function(){e&&window.clearTimeout(e);c||(document.body.style.cursor="default",c=!0,$(b.options.videoControlsSelector).addClass("open-controls"));e=window.setTimeout(a,1E3)};$("body").unbind("keydown").bind("keydown",function(a){})},createPlaybackControl:function(){var a=this;this.play_btn=
$(".vi2-video-play-pause");this.play_btn.bind("click",function(){a.play()});$(this.play_btn).bind("play",function(a){vi2.observer.play();$(".screen").remove()});$(this.play_btn).bind("pause",function(a){vi2.observer.pause()});$(vi2.observer.player).bind("player.play",function(a,e,c){});$(vi2.observer.player).bind("player.pause",function(a,e,c){})},createVolumeControl:function(){var a=this;this.volume=$(".vi2-volume-slider",this.video_container);this.volume_btn=$(".vi2-volume-button",this.video_container);
$(this.volume).slider({orientation:"horizontal",range:"min",max:1,step:0.05,animate:!1,value:a.options.defaultVolume,slide:function(b,e){0<e.value&&0.5>e.value?(a.isMuted=!1,a.volume_btn.addClass("glyphicon-volume-down"),a.volume_btn.removeClass("glyphicon-volume-up"),a.volume_btn.removeClass("glyphicon-volume-off")):0.5<=e.value?(a.isMuted=!1,a.volume_btn.removeClass("glyphicon-volume-down"),a.volume_btn.addClass("glyphicon-volume-up"),a.volume_btn.removeClass("glyphicon-volume-off")):(a.isMuted=
!0,a.volume_btn.removeClass("glyphicon-volume-down"),a.volume_btn.removeClass("glyphicon-volume-up"),a.volume_btn.addClass("glyphicon-volume-off"))},change:function(b,e){a.video.volume=e.value;0<e.value&&0.5>e.value?(a.isMuted=!1,a.volume_btn.addClass("glyphicon-volume-down"),a.volume_btn.removeClass("glyphicon-volume-up"),a.volume_btn.removeClass("glyphicon-volume-off")):0.5<=e.value?(a.isMuted=!1,a.volume_btn.removeClass("glyphicon-volume-down"),a.volume_btn.addClass("glyphicon-volume-up"),a.volume_btn.removeClass("glyphicon-volume-off")):
(a.isMuted=!0,a.volume_btn.removeClass("glyphicon-volume-down"),a.volume_btn.removeClass("glyphicon-volume-up"),a.volume_btn.addClass("glyphicon-volume-off"))}});this.volume_btn.bind("click",function(b){a.muteVolume()});0===this.volume.slider("value")?(this.isMuted=!0,this.volume_btn.addClass("glyphicon glyphicon-volume-off")):this.volume_btn.addClass("glyphicon glyphicon-volume-up")},getVolume:function(){return this.volume.slider("value")},setVolume:function(a){this.volume.slider("value",a);vi2.observer.log({context:"player",
action:"set-volume",values:[a]})},increaseVolume:function(){$(this.volume).slider("value",$(this.volume).slider("value")+0.05)},decreaseVolume:function(){$(this.volume).slider("value",$(this.volume).slider("value")-0.05)},tmp_volume:0,muteVolume:function(){this.isMuted?(this.setVolume(tmp_volume),this.isMuted=!1):(tmp_volume=this.volume.slider("value"),this.setVolume(0),this.isMuted=!0)},createVideoHiding:function(){},startSpinning:function(){this.spinner.spin(document.getElementById("overlay"));
$(".spinner").css("top","200px")},stopSpinning:function(){this.spinner.stop()},readyStateHandler:function(a){vi2.observer.updateVideo(this.seqList[this.seqNum].id,this.seqNum)},timeUpdateHandler:function(a){2===this.video.readyState?this.startSpinning():4===this.video.readyState&&this.stopSpinning()},endedHandler:function(a){vi2.observer.log({context:"player",action:"video-ended",values:[this.url]});vi2.observer.ended();this.video.removeEventListener("ended",arguments.callee,!1);this.isSequence&&
(this.seqNum+1<this.seqList.length||this.seqLoop)?(this.seqNum=(this.seqNum+1)%this.seqList.length,this.loadVideo(this.seqList[this.seqNum].url)):$(vi2.observer.player).trigger("video.end",null)},keyboardCommandHandler:function(a){a.preventDefault();this.video.focus();switch(a.which){case 32:this.play();break;case 189:vi2.observer.getWidget("playbackSpeed").decreaseSpeed();break;case 187:vi2.observer.getWidget("playbackSpeed").increaseSpeed();break;case 38:this.increaseVolume();break;case 40:this.decreaseVolume();
break;case 77:this.muteVolume();break;case 39:vi2.observer.widget_list.toc.nextElement();break;case 37:vi2.observer.widget_list.toc.previousElement();break;case 34:vi2.observer.player.play();break;case 33:vi2.observer.widget_list.toc.previousElement()}this.video.focus()},play:function(){!1===this.video.paused?(this.video.pause(),this.isPlaying(!1),$(vi2.observer.player).trigger("player.pause",[]),vi2.observer.clock.stopClock(),vi2.observer.log({context:"player",action:"pause-click",values:["1"]})):
(this.video.play(),this.isPlaying(!0),$(vi2.observer.player).trigger("player.play",[]),vi2.observer.clock.startClock(),vi2.observer.log({context:"player",action:"play-click",values:["1"]}))},pause:function(){this.video.pause();this.isPlaying(!1);$(vi2.observer.player).bind("player.pause");vi2.observer.log({context:"player",action:"pause2-click",values:["1"]})},isPlaying:function(a){if(void 0===a)return this.videoIsPlaying;this.videoIsPlaying=a},duration:function(){return this.video.duration},currentTime:function(a){if(void 0===
a)return this.video.currentTime;$(this.video).trigger("play");this.video.currentTime=a;this.play()},width:function(a){if(null===a)return $("#video1").width()},height:function(a){if(null===a)return $("#video1").height()},errorHandling:function(a){},logger:function(){function a(){var a;a=Math.round(e.currentTime())/c>>0;a!=f&&(vi2.observer.log({context:"player",action:"playback",values:[a]}),f=a)}function b(){g=clearInterval(g);a()}var e=this,c=5,f=-1,g;this.video.addEventListener("play",function(b){g&&
(g=clearInterval(g));g=setInterval(a,1E3*c);setTimeout(a,100)});this.video.addEventListener("pause",function(a){b()});this.video.addEventListener("abort",function(a){b()});this.video.addEventListener("timeupdate",function(a){});this.video.addEventListener("ended",function(a){b()},!1)}});
Vi2.Clock=$.inherit({__constructor:function(a){20<a&&5E3>a?this.clockInterval=a:console.log("Error")},name:"clock",clockInterval:500,isRunning:!1,interval:-1,annotations:[],hooks:[],isHook:function(a){return null!==this.hooks[a]},addHook:function(a,b){this.hooks[a]=b;return!0},addAnnotation:function(a){this.isHook(a.type)&&this.annotations.push({active:!1,author:a.author,width:a.width,content:{title:a.title,target:a.target,description:a.description,note:a.note},linktype:a.linktype,type:a.type,displayPosition:{x:a.x,
y:a.y,t1:a.t1,t2:a.t2},seek:a.seek,duration:a.duration,data:a})},checkAnnotation:function(){for(var a=this.parseTime(vi2.observer.player.currentTime()),b=this.annotations.length,e=0;e<b;e++){var c=this.annotations[e];a>=c.displayPosition.t1&&a<Number(c.displayPosition.t1)+Number(c.displayPosition.t2)?c.active||(c.active=!0,$(vi2.observer.player).trigger("annotation.begin."+c.type,[e,c])):(c.active=!1,$(vi2.observer.player).trigger("annotation.end."+c.type,[e,c]))}},prepAnno:[],buildAnnotationIndex:function(){for(var a=
[],b=0;1E3>b;b++)a[b]=[];$.each(this.annotations,function(b,c){var f=1>c.displayPosition.t1?0:Math.ceil(c.displayPosition.t1/100);a[f].push(c)});this.prepAnno=a},checkAnnotation_new:function(){var a=this.parseTime(vi2.observer.player.currentTime()),b=1>vi2.observer.player.currentTime()?0:Math.ceil(a/100);$.each(this.prepAnno[b],function(b,c){a>=c.displayPosition.t1&&a<Number(c.displayPosition.t1)+Number(c.displayPosition.t2)?c.active||(c.active=!0,$(vi2.observer.player).trigger("annotation.begin."+
c.type,[b,c])):(c.active=!1,$(vi2.observer.player).trigger("annotation.end."+c.type,[b]))})},startClock:function(){if(!this.isRunning){var a=this;this.isRunning=!0;this.interval=setInterval(function(){a.checkAnnotation()},this.clockInterval)}},stopClock:function(){clearInterval(this.interval);clearInterval(this.interval);this.isRunning=!1},reset:function(){$("#overlay").html("");this.annotations=[]},parseTime:function(a){return a}});
Vi2.Annotation=$.inherit({__constructor:function(a){this.options=a},name:"annotation",type:"annotation",options:{},init:function(a){},appendToDOM:function(a){},begin:function(a,b,e){},end:function(a,b){},animation:function(a,b){$(a).animate({left:100},{duration:1E3})},validateAnnotationForm:function(a,b){var e=0,c=0,f="";$(a).find("input[type=text]").each(function(a,b){""===$(b).val()?($(b).addClass("validation-conflict"),c=!0):$(b).removeClass("validation-conflict")});c&&(f+="\n Versehen Sie bitte die/das Textfeld/er mit einem Text.");
$(a).find("textarea").each(function(a,b){2>String($(b).val()).length?($(b).addClass("validation-conflict"),e=!0):$(b).removeClass("validation-conflict")});e&&(f+="\n Definieren Sie bitte einen Text f\u00fcr das Textfeld.");0<$(a).find("input[type=checkbox]").length&&0===$(a).find("input:checked").length?($(a).find("input[type=checkbox]").addClass("validation-conflict"),f=NaN):$(a).find("input[type=checkbox]").removeClass("validation-conflict");0!==String(f).length&&console.log("Validation Error:"+
f);return f},formatTime:function(a,b){b=b?b:"";var e=Math.round(a),c=Math.floor(e/60),e=Math.floor(e%60);return(10<=c?c:"0"+c)+b+(10<=e?e:"0"+e)}});jQuery.fn.dropdown=function(a){var b=$(this).find("h4"),e=$(this).html();$(this).toggle(function(){$(this).html(b.wrapInner("<h4></h4>").html())},function(){$(this).html(e).find("h4").attr("style","background-image:url(images/arrow_d.png); display:inline;")}).click()};
jQuery.fn.hidetext=function(a){a=$(this).text();return $(this).text(a.substr(0,250)+" ").append($("<span>more</span>"))};jQuery.fn.round=function(a){a||(a=0);return Math.round(this*Math.pow(10,a))/Math.pow(10,a)};function delegate(a,b){var e=function(){return arguments.callee.func.apply(arguments.callee.target,arguments)};e.target=a;e.func=b;return e}function removeDuplicates(a){a=a.sort();for(var b=1;b<a.length;)a[b-1]==a[b]?a.splice(b,1):b++;return a}
function timeDifference(a,b,e){var c=moment(a);a=moment(a);var f=a.diff(c,"seconds");if(60>=f)return b+f.toFixed(1)+"s"+e;f=a.diff(c,"minutes");if(60>=f)return b+f.toFixed(1)+"min"+e;f=a.diff(c,"hours",!0);if(24>=f)return b+f.toFixed(1)+"h"+e;f=a.diff(c,"days",!0);if(30>f)return b+f.toFixed(1)+"d"+e;f=a.diff(c,"months",!0);if(12>f)return b+f.toFixed(1)+"m"+e;f=a.diff(c,"years",!0);return b+f.toFixed(1)+"y"+e}Object.size=function(a){var b=0,e={};for(e in a)a.hasOwnProperty(e)&&b++;return b};
Vi2.Utils=$.inherit({__constructor:function(a){},name:"utils",seconds2decimal:function(a){d=Number(a);a=Math.floor(d/3600);var b=Math.floor(d%3600/60),e=Math.floor(d%3600%60);return(0<a?a+":":"")+(0<b?(0<a&&10>b?"0":"")+b+":":"00:")+(10>e?"0":"")+e},deci2seconds:function(a){if(0>Number(a)||void 0===a)return 0;a=a.split(":");return 3600*Number(a[0])+60*Number(a[1])+Number(a[2])}});
Vi2.Log=$.inherit({__constructor:function(a){this.options=$.extend(this.options,a);this.userAgent=this.getUserAgent()},name:"log",options:{output:"logfile",debug_selector:"#debug",prefix:"",logfile:"log.txt",parameter:"time,ip,msg,user",logger_path:"-1"},bucket:"",ip:"",init:function(){},add:function(a){if("string"===typeof a)console.log("warning: uncaptured log emtrie: "+a);else{var b=vi2.observer.player.currentTime();t=new Date;t=t.getTime();a={utc:t,user:vi2.userData.id,video_id:vi2.currentVideo,
action:a,playback_time:void 0===b?-1:b,user_agent:this.getUserAgent()};this.writeLog(a)}},getLogs:function(){return this.bucket},getLogTime:function(){var a=new Date,b=a.getSeconds(),e=a.getMinutes(),c=a.getHours(),f=a.getDate(),g=a.getMonth()+1,h=a.getFullYear();return{utc:a.getTime(),date:h+"-"+(9>=g?"0"+g:g)+"-"+(9>=f?"0"+f:f),time:(9>=c?"0"+c:c)+":"+(9>=e?"0"+e:e)+":"+(9>=b?"0"+b:b)+":"+a.getMilliseconds()}},getIP:function(){return this.ip},getUserAgent:function(){return navigator.userAgent.replace(/,/g,
";")},writeLog:function(a){"-1"!==this.options.logger_path&&$.post(this.options.logger_path,{data:a},function(a){})}});
Vi2.Metadata=$.inherit({__constructor:function(a){this.metadata=vi2.db.getMetadataById(vi2.observer.current_stream);this.options=$.extend(this.options,a);this.update()},options:{selector:".metadata",requiresMetatags:!0,requiresDisplay:!0},update:function(){this.options.requiresDisplay&&this.displayMetadata();this.options.requiresMetatags&&this.buildMetaTags()},displayMetadata:function(){},buildMetaTags:function(){$("head meta").each(function(a,b){$(b).remove()});$("head").prepend('<meta content="text/html;charset=utf-8" http-equiv="Content-Type">').prepend('<meta content="utf-8" http-equiv="encoding">').prepend('<meta http-equiv="X-UA-Compatible" content="IE=Edge"/>').prepend('<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />').prepend('<meta itemprop="duration" content="'+
this.metadata.length+'" />').prepend('<meta itemprop="height" content="'+vi2.observer.player.height()+'" />').prepend('<meta itemprop="width" content="'+vi2.observer.player.width()+'" />').prepend('<meta itemprop="uploadDate" content="'+this.metadata.date+'" />').prepend('<meta itemprop="contentURL" content="'+vi2.db.getStreamById(vi2.observer.current_stream).video+'" />')}});
Vi2.AnnotatedTimeline=$.inherit({__constructor:function(a,b,e){this.video=a;this.options=$.extend(this.options,b);this.seek=void 0===e?0:e;this.init()},name:"annotated timeline",type:"core",options:{timelineSelector:".vi2-timeline-main",hasPreview:!1,hasSlidePreview:!1,previewPath:"/static/img/video-stills/theresienstadt/still-image-",hasMarker:!0,path:"/"},video:null,seek:0,seeksliding:!1,video_seek:null,video_loading_progress:null,video_timer:null,interval:0,percentLoaded:0,video_container:null,
cursorX:0,init:function(a){var b=this;this.video_seek=$(this.options.timelineSelector);this.video_loading_progress=$(".vi2-timeline-progress");this.video_timer=$(".vi2-video-timer");var e=0,c=0;this.video.onloadstart=function(a){e=Date.now()};this.video.ondurationchange=function(){c=Date.now()-e;b.handleDurationChange()};this.video.onloadedmetadata=function(a){};this.video.onloadeddata=function(a){vi2.observer.log({context:"player",action:"video-loading-time",values:[c,Date.now()-e]})};this.video.onprogress=
function(a){};this.video.oncanplay=function(a){};this.video.oncanplaythrough=function(a){};this.video.addEventListener("timeupdate",function(a){b.handleTimeupdate(a)})},createTimelineControl:function(){var a=this;this.video_seek.slider({value:0,step:0.01,orientation:"horizontal",range:"min",max:vi2.observer.player.duration(),animate:!1,slide:function(b,e){a.seeksliding=!0},start:function(b,e){vi2.observer.log({context:"player",action:"seek-start",values:[e.value]});a.buffclick++;a.seeksliding=!0},
stop:function(b,e){vi2.observer.log({context:"player",action:"seek-stop",values:[e.value]});a.seeksliding=!1;vi2.observer.player.currentTime(parseFloat(Math.ceil(e.value)))}})},createTimelineVideoPreview:function(){var a=this,b=$(this.options.timelineSelector).width();$(this.options.timelineSelector).offset();var e=1,c=null,f=new Image;f.id="videopreview";var g=$("<div></div>").addClass("vi2-timeline-preview").html(f).appendTo(a.options.timelineSelector),f=function(f){$(g).css({left:f.pageX-100});
e=Math.round(f.pageX/b*vi2.observer.player.duration())-20;c=new Image;img_selector=document.getElementById("videopreview");listener=function(a){img_selector.src=c.src};c.removeEventListener("load",listener,!1);c.addEventListener("load",listener,!1);c.src=a.options.previewPath+""+e+".jpg";c.onerror=function(){this.style.display="none"}},h=document.getElementsByClassName("vi2-timeline-main");h[0].removeEventListener("mousemove",f);h[0].addEventListener("mousemove",f)},createTimelineSlidePreview:function(){var a=
this,b=$(this.options.timelineSelector).width();$(this.options.timelineSelector).offset();var e=1,c=null,f=$("<div></div>").addClass("vi2-timeline-preview").appendTo(this.options.timelineSelector);document.getElementsByClassName("vi2-timeline-main")[0].addEventListener("mousemove",function(g){$(f).css({left:g.pageX-100});e=Math.floor(vi2.observer.player.duration()/b*Math.floor(g.pageX)).toString();c=new Image;c.src=a.options.previewPath+""+e+".png";listener=function(a){$(f).html(c)};c.removeEventListener("load",
listener,!0);c.addEventListener("load",listener,!0)},!1)},addTimelineMarkers:function(a,b,e){var c=this;void 0===e&&(e=this.options.timelineSelector);this.options[a]={markerHasTooltip:!0,markerIsClickable:!0};var f=$(e);$("."+a+"-timeline-marker").each(function(a,b){$(b).remove()});$.each(b,function(b,h){var k=h.occ[0]/vi2.observer.player.duration(),k=k*$(e).width();isNaN(k)||k>$(e).width()||(k=$("<a></a>").addClass(a+"-timeline-marker ttoc").attr("style","left:"+k+"px;"),c.options[a].markerHasTooltip&&
k.attr("title",h.name).attr("data-toggle","tooltip"),c.options[a].markerIsClickable&&k.bind("click",function(b){vi2.observer.player.currentTime(h.occ[0]);vi2.observer.log({context:a,action:"timeline-link-click",values:[h.name,h.author,h.occ[0]]})}),f.append(k))})},handleDurationChange:function(a){this.createTimelineControl();vi2.observer.player.currentTime(this.seek);$(vi2.observer).trigger("player.ready",[vi2.observer.player.seqList[vi2.observer.player.seqNum].id,vi2.observer.player.seqNum])},handleProgress:function(a){var b=
this.video;percent=null;b&&b.buffered&&0<b.buffered.length&&b.buffered.end&&b.duration?percent=b.buffered.end(0)/b.duration:b&&void 0!==b.bytesTotal&&0<b.bytesTotal&&void 0!==b.bufferedBytes?percent=b.bufferedBytes/b.bytesTotal:a&&(a.lengthComputable&&0!==a.total)&&(percent=a.loaded/a.total);null!==percent&&(this.percentLoaded=percent,percent=Math.min(1,Math.max(0,percent)),this.video_loading_progress&&this.video_seek&&this.video_loading_progress.width(this.video_seek.width()*percent))},handleTimeupdate:function(a){!this.seeksliding&
void 0!==vi2.observer.player&&this.video_seek.slider("value",vi2.observer.player.currentTime())},pixelInTime:function(){}});
Vi2.VideoManager=$.inherit({__constructor:function(a){this.options=$.extend(this.options,a)},name:"video-manager",type:"collection",content_selector:"#content",options:{selector:"#seq"},viewing_history:[],init:function(){var a=this;Sammy(this.options.selector,function(){this.get("#!/video/:stream/:time",function(){a.handleNewStream(this.params)});this.get("#!/video/:stream",function(){a.handleNewStream(this.params)});this.get("#!/videos/all",function(){a.handleAllStreams()});this.get("#!/tags/:tag",
function(){a.handleTags(this.params)});this.get("#!/category/:category",function(){a.handleCategory(this.params)})}).run()},addRoute:function(a,b,e){Sammy(this.options.selector,function(){this.get("#!"+a,function(){b[e]()})}).run()},render:function(a,b){return(new EJS({url:vi2.templatePath+""+a})).render(b)},handleTags:function(a){a=a.tag.split(/,/);for(var b="",e=[],c=vi2.db.getInvertedTagIndex(),f=0;f<a.length;f++)void 0!==c[a[f]]&&(b+=c[a[f]].toString()+",");c=[];c=removeDuplicates(b.split(/,/));
for(b=0;b<c.length;b++)""!==c[b]&&(f=vi2.db.getStreamById(c[b]),e.push(f));a=this.render("vi2.video-manager.ejs",{title:"Tags: "+a.toString(),items:e});$(this.options.selector).html(a)},handleCategory:function(a){a=a.category;var b=vi2.db.getStreamsByCategory(a);a=this.render("vi2.video-manager.ejs",{title:"Category: "+a,items:b});$(this.options.selector).html(a)},handleAllStreams:function(a){a=vi2.db.getAllStreams();a=this.render("vi2.video-manager.ejs",{title:"Category: "+category,items:a});$(this.options.selector).html(a)},
handleNewStream:function(a){var b=void 0===a.time?0:a.time.split(/:/)[1];a.stream!=vi2.observer.current_stream?($(vi2.dom).empty(),vi2.observer.setCurrentStream(a.stream,b),vi2.observer.player.play(),this.loadWidgets()):vi2.observer.player.currentTime(b)},loadWidgets:function(){var a=new Vi2.TableOfContents({hasTimelineMarker:!0,hasMenu:!0,menuSelector:".toc"}),b=new Vi2.SyncronizeMedia({selector:".syncMedia",hasTimelineMarker:!0,hasMenu:!0,menuSelector:".toc"}),e=new Vi2.RelatedVideos({resultSelector:".related-videos",
criteria:[{criterion:"random-destructor",weight:0.1},{criterion:"same-author",weight:0.8},{criterion:"same-tags",weight:0.6},{criterion:"incomming-links",weight:0.5},{criterion:"outgoing-links",weight:0.5}]});vi2.observer.addWidget(a);vi2.observer.addWidget(b);vi2.observer.addWidget(e)},listAllItems:function(){var a=$("#item_template").val();$.each(this.getCategoryTaxonomie(),function(b,e){$(_this.content_selector).append($("<h2></h2>").addClass("cat"+b).text(e)).append("<br>");$.each(_this.json_data.stream,
function(b,f){f.metadata[0].category==e&&$("<div></div>").setTemplate(a).processTemplate(f).appendTo($(_this.content_selector))})})}});
Vi2.PlaybackSpeed=$.inherit({__constructor:function(a){this.options=$.extend(this.options,a);this.video=document.getElementById(this.options.videoSelector)},name:"playbackSpeed",type:"player-widget",options:{selector:".control-bar",videoSelector:"video1",speed_steps:[0.3,0.5,0.7,1,1.5,1.7,2]},speed:1,video:"",speedIndex:3,init:function(a){var b=this;$(this.options.selector+"> .vi2-speed-controls").remove();a=$("<div></div>").append($("<div></div>").text("1.0x").addClass("speed-label")).addClass("vi2-speed-controls").bind("mouseenter",
function(a){$(".vi2-speed-controls > ul").css("display","block")}).bind("mouseleave",function(a){$(".vi2-speed-controls > ul").css("display","none")}).appendTo(this.options.selector);var e=$("<ul></ul>").addClass("select-speed").appendTo(a);$.each(this.options.speed_steps,function(a,f){$("<li></li>").attr("speed",f).text(f+"x").click(function(a){b.setCurrentSpeed($(this).attr("speed"))}).appendTo(e)})},displaySpeed:function(){},getCurrentSpeed:function(){return this.speed},setCurrentSpeed:function(a){-1!==
this.options.speed_steps.indexOf(parseFloat(a))&&(vi2.observer.log({context:"playbackSpeed",action:"change-speed",values:[this.speed,a]}),this.video.defaultPlaybackRate=1,this.speed=this.video.playbackRate=a,this.speedIndex=this.options.speed_steps.indexOf(parseFloat(a)),$(".speed-label").text(a+"x"),$(".vi2-speed-controls > ul").css("display","none"))},increaseSpeed:function(){this.speedIndex<this.options.speed_steps.length&&this.setCurrentSpeed(this.options.speed_steps[this.speedIndex+1])},decreaseSpeed:function(){1<
this.speedIndex&&this.setCurrentSpeed(this.options.speed_steps[this.speedIndex-1])}});
Vi2.Zoom=$.inherit({__constructor:function(a){this.options=$.extend(this.options,a)},name:"zoom",type:"player-widget",options:{videoSelector:"#video1",controlSelector:".control-bar",hasControls:!0,hasReset:!0,haseSlider:!0,min:1,max:4,steps:0.25},init:function(){$(this.options.controlSelector+"> .zoom-controls").remove();var a=$("<div></div>").addClass("zoom-controls").appendTo(this.options.controlSelector);this.options.hasSlider&&$("<input></input>").attr("type","range").addClass("vi2-zoom-range").appendTo(a);
this.options.hasControls&&($("<button></button>").text("-").addClass("vi2-zoom-out").prependTo(a),$("<button></button>").text("+").addClass("vi2-zoom-in").appendTo(a));this.options.hasReset&&$("<button></button>").text("reset").addClass("vi2-zoom-reset").appendTo(a);$(this.options.videoSelector).panzoom({cursor:"move",increment:this.options.steps,minScale:this.options.min,maxScale:this.options.max,rangeStep:this.options.steps,transition:!0,duration:200,easing:"ease-in-out",$zoomIn:$(".vi2-zoom-in"),
$zoomOut:$(".vi2-zoom-out"),$zoomRange:$(".vi2-zoom-range"),$reset:$(".vi2-zoom-reset"),focal:{clientX:108,clientY:132}})}});
Vi2.Sharing=$.inherit({__constructor:function(a){this.options=$.extend(this.options,a)},name:"sharing",type:"player-plugin",options:{selector:".control-bar",shareLink:!0,shareEmbedLink:!0,label:"</>"},init:function(){var a=this,b=window.location.href;$(this.options.selector+"> .vi2-sharing-controls").remove();var a=this,e=$("<div></div>").append($("<div></div>").text(this.options.label).addClass("sharing-label")).addClass("vi2-sharing-controls").bind("mouseenter",function(a){}).appendTo(this.options.selector),
e=$("<div></div>").addClass("vi2-sharing-select").appendTo(e);a.options.shareLink&&$('<input type="text" />').val(b).attr("readonly",!0).attr("aria-describedby","URL to the current playback position of the video.").focus(function(){$(this).select()}).appendTo(e)},prepareEmbedMarkup:function(){var a=$();$("<script>\x3c/script").attr("type","text/javascript");return a.html()}});
Vi2.SkipBack=$.inherit({__constructor:function(a){this.options=$.extend(this.options,a)},name:"skipBack",type:"player-widget",options:{selector:".control-bar",label:"",step:5},init:function(){$(this.options.selector+"> .vi2-skipback-controls").remove();var a=this;$("<div></div>").append($("<div></div>").text(this.options.label).addClass("vi2-skipback-label glyphicon glyphicon-step-backward")).addClass("vi2-skipback-controls vi2-btn").attr("title",this.options.step+"s zur\u00fcckspringen").bind("click",
function(b){b=vi2.observer.player.currentTime();var e=Number(Number(b)-Number(a.options.step));vi2.observer.log({context:"skipBack",action:"skip-back",values:[b,String(e)]});vi2.observer.player.currentTime(e)}).prependTo(this.options.selector)}});
